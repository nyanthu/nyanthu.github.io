<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>[NyanthuEngine] - Addon Editor</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
    <style>
        body, html {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        #container {
            height: 100%;
            width: 100%;
        }
    </style>
</head>
<body>
    <div id="container"></div>
    <script>
        require.config({ paths: { vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' } });
        require(['vs/editor/editor.main'], function () {
            // Lua言語の定義 (Monarchトークナイザー)
            monaco.languages.register({ id: 'lua' });
            monaco.languages.setMonarchTokensProvider('lua', {
                // keywords を tokenizer の外に移動
                keywords: [
                    'and', 'break', 'do', 'else', 'elseif', 'end', 'false', 'for', 'function',
                    'if', 'in', 'local', 'nil', 'not', 'or', 'repeat', 'return', 'then', 'true',
                    'until', 'while', 'n_gate'
                ],
                tokenizer: {
                    root: [
                        [/[a-zA-Z_]\w*/, {
                            cases: {
                                '@keywords': 'keyword',
                                '@default': 'identifier'
                            }
                        }],
                        [/--\[\[[\s\S]*?\]\]/, 'comment'],  // マルチラインコメント
                        [/--.*$/, 'comment'],               // シングルラインコメント
                        [/[0-9]+(\.[0-9]+)?/, 'number'],   // 数値
                        [/".*?"/, 'string'],               // 文字列 (ダブルクォート)
                        [/\'.*?\'/, 'string'],             // 文字列 (シングルクォート)
                        [/[\[\]\(\)\{\}]/, 'delimiter.bracket'],
                        [/[,;]/, 'delimiter'],
                        [/[-+\/*=<>!&|~^%#]+/, 'operator']
                    ]
                }
            });

            // エディターの作成
            monaco.editor.create(document.getElementById('container'), {
                value: '--\n-- [NyanthuEngine] - Addon Editor\n--\n\nlocal function n_gate()\n    print("Hello, Lua!")\nend\nhello()',
                language: 'lua',
                theme: 'vs-dark',  // テーマを変更可能 (vs, vs-dark, hc-black など)
                automaticLayout: true  // ウィンドウサイズに自動調整
            });
        });
    </script>
</body>
</html>
